"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = {
    name: "pong",
    description: "Classic Pong game - use W/S keys",
    code: "\nfunction initGameClient(container, socket, roomId, emitAction) {\n  const canvas = document.createElement('canvas');\n  canvas.width = 800;\n  canvas.height = 600;\n  canvas.style.cssText = 'display: block; margin: 20px auto; background: #000; border: 2px solid #fff;';\n  container.appendChild(canvas);\n\n  const ctx = canvas.getContext('2d');\n\n  const statusDiv = document.createElement('div');\n  statusDiv.style.cssText = 'text-align: center; margin-top: 20px; font-size: 18px; color: #fff;';\n  container.appendChild(statusDiv);\n\n  document.addEventListener('keydown', (e) => {\n    if (e.code === 'KeyW') emitAction('move', { direction: 'up' });\n    if (e.code === 'KeyS') emitAction('move', { direction: 'down' });\n  });\n\n  function render(state) {\n    ctx.fillStyle = '#000';\n    ctx.fillRect(0, 0, canvas.width, canvas.height);\n\n    // Draw center line\n    ctx.strokeStyle = '#444';\n    ctx.setLineDash([10, 10]);\n    ctx.beginPath();\n    ctx.moveTo(400, 0);\n    ctx.lineTo(400, 600);\n    ctx.stroke();\n    ctx.setLineDash([]);\n\n    // Draw paddles\n    ctx.fillStyle = '#fff';\n    ctx.fillRect(20, state.paddle1Y || 250, 10, 100);\n    ctx.fillRect(770, state.paddle2Y || 250, 10, 100);\n\n    // Draw ball\n    ctx.fillRect(state.ballX || 400, state.ballY || 300, 10, 10);\n\n    // Draw scores\n    ctx.font = '48px Arial';\n    ctx.fillText((state.score1 || 0) + ' - ' + (state.score2 || 0), 350, 50);\n\n    // Update status\n    const playerCount = state.playerAssignments ? Object.keys(state.playerAssignments).length : 0;\n    const myPaddle = state.playerAssignments ? state.playerAssignments[socket.id] : null;\n\n    if (playerCount < 2) {\n      statusDiv.textContent = 'Waiting for opponent... (' + playerCount + '/2 players)';\n    } else if (myPaddle) {\n      statusDiv.textContent = 'You are Player ' + myPaddle + ' (left side: ' + (myPaddle === 1 ? 'YOU' : 'opponent') + ', right side: ' + (myPaddle === 2 ? 'YOU' : 'opponent') + ')';\n    } else {\n      statusDiv.textContent = 'You are spectating';\n    }\n  }\n\n  return {\n    onStateUpdate: (state) => render(state)\n  };\n}\n\nconst serverLogic = {\n  initialState: {\n    paddle1Y: 250,\n    paddle2Y: 250,\n    ballX: 400,\n    ballY: 300,\n    ballVX: 5,\n    ballVY: 5,\n    score1: 0,\n    score2: 0,\n    playerAssignments: {},\n    lastUpdateTime: Date.now()\n  },\n  moves: {\n    playerJoined: (state, payload, playerId) => {\n      // Assign players to paddles\n      if (!state.playerAssignments[playerId]) {\n        const assignedPlayers = Object.keys(state.playerAssignments).length;\n        if (assignedPlayers === 0) {\n          state.playerAssignments[playerId] = 1; // First player gets left paddle\n        } else if (assignedPlayers === 1) {\n          state.playerAssignments[playerId] = 2; // Second player gets right paddle\n        }\n        // Additional players become spectators (no assignment)\n      }\n    },\n\n    move: (state, payload, playerId) => {\n      const playerPaddle = state.playerAssignments[playerId];\n      if (!playerPaddle) return; // Spectator or unassigned\n\n      const paddle = playerPaddle === 1 ? 'paddle1Y' : 'paddle2Y';\n\n      if (payload.direction === 'up') {\n        state[paddle] = Math.max(0, state[paddle] - 25);\n      } else if (payload.direction === 'down') {\n        state[paddle] = Math.min(500, state[paddle] + 25);\n      }\n    },\n\n    tick: (state) => {\n      // Game loop - called periodically to update ball physics\n      const now = Date.now();\n      const deltaTime = (now - state.lastUpdateTime) / 16.67; // Normalize to 60fps\n      state.lastUpdateTime = now;\n\n      // Update ball position\n      state.ballX += state.ballVX * deltaTime;\n      state.ballY += state.ballVY * deltaTime;\n\n      // Ball collision with top/bottom walls\n      if (state.ballY <= 0 || state.ballY >= 590) {\n        state.ballVY *= -1;\n        state.ballY = Math.max(0, Math.min(590, state.ballY));\n      }\n\n      // Ball collision with left paddle\n      if (state.ballX <= 30 && state.ballX >= 20) {\n        if (state.ballY >= state.paddle1Y && state.ballY <= state.paddle1Y + 100) {\n          state.ballVX = Math.abs(state.ballVX); // Bounce right\n          // Add spin based on where ball hits paddle\n          const hitPos = (state.ballY - state.paddle1Y) / 100; // 0 to 1\n          state.ballVY = (hitPos - 0.5) * 10;\n        }\n      }\n\n      // Ball collision with right paddle\n      if (state.ballX >= 760 && state.ballX <= 770) {\n        if (state.ballY >= state.paddle2Y && state.ballY <= state.paddle2Y + 100) {\n          state.ballVX = -Math.abs(state.ballVX); // Bounce left\n          // Add spin based on where ball hits paddle\n          const hitPos = (state.ballY - state.paddle2Y) / 100; // 0 to 1\n          state.ballVY = (hitPos - 0.5) * 10;\n        }\n      }\n\n      // Ball goes out of bounds - scoring\n      if (state.ballX < 0) {\n        // Player 2 scores\n        state.score2 += 1;\n        state.ballX = 400;\n        state.ballY = 300;\n        state.ballVX = -5; // Serve towards player 1\n        state.ballVY = (Math.random() - 0.5) * 6;\n      } else if (state.ballX > 800) {\n        // Player 1 scores\n        state.score1 += 1;\n        state.ballX = 400;\n        state.ballY = 300;\n        state.ballVX = 5; // Serve towards player 2\n        state.ballVY = (Math.random() - 0.5) * 6;\n      }\n\n      // Cap ball velocity to prevent it from going too fast\n      const maxSpeed = 12;\n      if (Math.abs(state.ballVX) > maxSpeed) {\n        state.ballVX = Math.sign(state.ballVX) * maxSpeed;\n      }\n      if (Math.abs(state.ballVY) > maxSpeed) {\n        state.ballVY = Math.sign(state.ballVY) * maxSpeed;\n      }\n    }\n  }\n};\n"
};
